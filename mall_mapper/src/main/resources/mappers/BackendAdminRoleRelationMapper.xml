<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nexus.mall.dao.BackendAdminRoleRelationMapper">
  <resultMap id="BaseResultMap" type="com.nexus.mall.pojo.BackendAdminRoleRelation">
    <!--
      WARNING - @mbg.generated
    -->
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="admin_id" jdbcType="BIGINT" property="adminId" />
    <result column="role_id" jdbcType="BIGINT" property="roleId" />
  </resultMap>
  <sql id="Base_Column_List">
    id, admin_id, role_id
  </sql>

  <select id="getResourceList" resultType="com.nexus.mall.pojo.BackendResource">
    select
      ur.id id,
      ur.create_time createTime,
      ur.`name` `name`,
      ur.url url,
      ur.description description,
      ur.category_id categoryId
    FROM
      backend_admin_role_relation ar
    LEFT JOIN backend_role r ON ar.role_id = r.id
    LEFT JOIN backend_role_resource_relation rrr ON r.id = rrr.role_id
    LEFT JOIN backend_resource ur ON ur.id = rrr.resource_id
    WHERE
        ar.admin_id = #{adminId}
    AND ur.id IS NOT NULL
    GROUP BY
        ur.id
  </select>
</mapper>